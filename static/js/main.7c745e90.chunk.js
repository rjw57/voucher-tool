(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{181:function(e,a,n){e.exports=n(427)},186:function(e,a,n){},190:function(e,a){},192:function(e,a){},229:function(e,a){},230:function(e,a){},427:function(e,a,n){"use strict";n.r(a);var t=n(0),r=n.n(t),l=n(25),i=n.n(l),c=(n(186),n(166)),u=n(167),o=n(179),s=n(168),m=n(180),d=n(86),p=n(48),h=n(175),E=n.n(h),g=n(176),f=n.n(g),v=n(177),b=n.n(v),V=n(61),w=n.n(V),y=n(29),j=n.n(y),k=n(178),I=n(170),B=n.n(I),x=n(172),C=n.n(x),Q=n(174),K=n.n(Q),L=n(19),O=n.n(L),S=n(173),D=n.n(S),F=n(26),N=n.n(F),P=n(87),Y=n(169),U=function(e){return Y.unix(e).utc().format("LLL")},X=function(e){var a=e.jti,n=e.val,t=e.aud,l=e.iss,i=e.crsid,c=e.iat,u=e.nbf,o=e.exp;return r.a.createElement(C.a,null,r.a.createElement(D.a,null,r.a.createElement(N.a,null,r.a.createElement(O.a,null,"Claim"),r.a.createElement(O.a,null,"Value"))),r.a.createElement(K.a,null,r.a.createElement(N.a,null,r.a.createElement(O.a,null,"Unique id"),r.a.createElement(O.a,null,a)),r.a.createElement(N.a,null,r.a.createElement(O.a,null,"Value"),r.a.createElement(O.a,null,n)),r.a.createElement(N.a,null,r.a.createElement(O.a,null,"User"),r.a.createElement(O.a,null,i)),r.a.createElement(N.a,null,r.a.createElement(O.a,null,"Issuer"),r.a.createElement(O.a,null,T[l].description)),r.a.createElement(N.a,null,r.a.createElement(O.a,null,"Intended use"),r.a.createElement(O.a,null,t)),r.a.createElement(N.a,null,r.a.createElement(O.a,null,"Issued at"),r.a.createElement(O.a,null,c?U(c):"\u2014")),r.a.createElement(N.a,null,r.a.createElement(O.a,null,"Invalid before"),r.a.createElement(O.a,null,u?U(u):"\u2014")),r.a.createElement(N.a,null,r.a.createElement(O.a,null,"Invalid after"),r.a.createElement(O.a,null,o?U(o):"\u2014"))))},H=function(e){var a,n=[];try{a=P.decode(e,{complete:!0})}catch(c){return n.push("Voucher cannot be decoded: ".concat(c.message)),{isValid:!1,errors:n}}if(null===a)return n.push("Voucher cannot be decoded."),{isValid:!1,errors:n};var t=a.header;if(!t||!t.iss)return n.push('Header lacks "iss" claim'),{isValid:!1,header:t,errors:n};var r=T[t.iss];if(!r)return n.push('Voucher issuer "'.concat(t.iss,'" is unknown')),{isValid:!1,header:t,errors:n};if(!t||!t.aud)return n.push('Header lacks "aud" claim'),{isValid:!1,header:t,errors:n};var l=t.aud;if(!A.has(l))return n.push('Audience "'.concat(l,'" is unknown')),{isValid:!1,header:t,errors:n};var i=null;try{if(!(i=P.verify(e,r.key,{algorithms:["ES256"],audience:l,issuer:t.iss})))return n.push("Voucher has empty payload"),{isValid:!1,header:t,errors:n}}catch(c){return n.push("Voucher could not be verified: ".concat(c.message)),{isValid:!1,header:t,errors:n}}return i.jti?i.val?isNaN(Number(i.val))?(n.push('"val" claim could not be parsed as a number'),{isValid:!1,header:t,errors:n}):{isValid:!0,header:t,payload:i,errors:n}:(n.push('Payload lacks "val" claim'),{isValid:!1,header:t,errors:n}):(n.push('Payload lacks "jti" claim'),{isValid:!1,header:t,errors:n})},A=new Set(["ssgw","ssge-dev","ssgw-test"]),T={"ifs-test-iuph8yaith":{description:"IFS Test",key:"-----BEGIN PUBLIC KEY-----\nMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAER/JQFfpKZinH3btYjuoYTZ9dqodt\nEmHWiOCaVXVg9X2xacp7DKMJDobv9vQhXHuBo+QkRnwfcgZ0mMgXL7QxDw==\n-----END PUBLIC KEY-----"},"ifs-live-eibah7hah8":{description:"IFS Production",key:"-----BEGIN PUBLIC KEY-----\nMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEbFSlXcqD9S4yBeV9UUPajH13Qo5j\niNQivxKBEUCX/fQ18XKhV7stCPTVX7lExw7RBJ3B/f42+S55jIrXlfqk9g==\n-----END PUBLIC KEY-----"}},Z=function(){var e=Object(t.useState)(""),a=Object(k.a)(e,2),n=a[0],l=a[1],i=H(n),c=(i.header,i.payload),u=i.isValid,o=i.errors;return r.a.createElement(r.a.Fragment,null,r.a.createElement(B.a,{id:"outlined-multiline-flexible",label:"Voucher",placeholder:"Enter voucher",autoFocus:!0,InputLabelProps:{shrink:!0},multiline:!0,rowsMax:"6",margin:"normal",variant:"outlined",fullWidth:!0,value:n,onChange:function(e){return l(e.target.value)}}),u&&r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{variant:"h6"},"Voucher is valid")),!u&&r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{variant:"h6",gutterBottom:!0},"Voucher is invalid"),o&&o.length>0&&o.map(function(e,a){return r.a.createElement(j.a,{key:a},e)})),u&&c&&r.a.createElement(X,c))},W=Object(p.withStyles)(function(e){return Object(p.createStyles)({appBar:{position:"relative"},layout:Object(d.a)({width:"auto",marginLeft:2*e.spacing.unit,marginRight:2*e.spacing.unit},e.breakpoints.up(600+2*e.spacing.unit*2),{width:600,marginLeft:"auto",marginRight:"auto"}),paper:Object(d.a)({marginTop:3*e.spacing.unit,marginBottom:3*e.spacing.unit,padding:2*e.spacing.unit},e.breakpoints.up(600+3*e.spacing.unit*2),{marginTop:6*e.spacing.unit,marginBottom:6*e.spacing.unit,padding:3*e.spacing.unit}),stepper:{padding:"".concat(3*e.spacing.unit,"px 0 ").concat(5*e.spacing.unit,"px")},buttons:{display:"flex",justifyContent:"flex-end"},button:{marginTop:3*e.spacing.unit,marginLeft:e.spacing.unit}})})(function(e){var a=e.classes;return r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,null),r.a.createElement(f.a,{position:"absolute",color:"primary",className:a.appBar},r.a.createElement(b.a,null,r.a.createElement(j.a,{variant:"h6",color:"inherit",noWrap:!0},"Voucher verifier"))),r.a.createElement("main",{className:a.layout},r.a.createElement(w.a,{className:a.paper},r.a.createElement(j.a,{component:"h1",variant:"h5",gutterBottom:!0},"SSGW Voucher Debugger"),r.a.createElement(j.a,{component:"p",gutterBottom:!0},"This site helps you debug vouchers for the self service gateway."),r.a.createElement(Z,null))))}),J=function(e){function a(){return Object(c.a)(this,a),Object(o.a)(this,Object(s.a)(a).apply(this,arguments))}return Object(m.a)(a,e),Object(u.a)(a,[{key:"render",value:function(){return r.a.createElement(W,null)}}]),a}(t.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(J,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[181,1,2]]]);
//# sourceMappingURL=main.7c745e90.chunk.js.map